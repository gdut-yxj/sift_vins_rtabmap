%YAML:1.0
---

imu: 1
num_of_cam: 2

# 数据集实际话题
imu_topic: "/snappy_imu"
image0_topic: "/snappy_cam/stereo_l"
image1_topic: "/snappy_cam/stereo_r"
output_path: "/home/l/output/UZH-FPV.txt"

# 标定文件路径
cam0_calib: "snappy0_cam.yaml"
cam1_calib: "snappy1_cam.yaml"

image_width: 640   # 从camera_info获取
image_height: 480  # 从camera_info获取

# 外参标定 (设为单位矩阵，D455通常IMU和相机已对齐)
estimate_extrinsic: 0
body_T_cam0: !!opencv-matrix
  rows: 4
  cols: 4
  dt: d
  data: [-0.02725669, -0.71392061, 0.69969596, 0.00751450,
         -0.99962607, 0.01793147, -0.02064447, 0.02404535,
         0.00219194, -0.69999702, -0.71414240, 0.00577265,
         0.0, 0.0, 0.0, 1.0]




# 右相机外参 (直接使用 Kalibr 的 T_cam_imu)
body_T_cam1: !!opencv-matrix
  rows: 4
  cols: 4
  dt: d
  data: [-0.01749277, -0.70909920, 0.70489171, 0.00670958,
         -0.99979147, 0.01983523, -0.00485745, -0.05587359,
         -0.01053728, -0.70482969, -0.70929829, 0.00423116,
         0.0, 0.0, 0.0, 1.0]

# 多线程支持
multiple_thread: 1

# 特征跟踪参数 (针对D455调整)
max_cnt: 200           # D455分辨率高，可以增加特征点
min_dist: 25           # 适当减小间距
freq: 30               # 匹配相机帧率
F_threshold: 0.8        # 降低阈值提高鲁棒性
show_track: 1          # 显示跟踪
flow_back: 1           # 启用反向光流

# 优化参数
max_solver_time: 0.05  # 增加时间应对高分辨率
max_num_iterations: 8
keyframe_parallax: 8.0 # 降低阈值

acc_n: 0.002
gyr_n: 0.00016968
acc_w: 0.003
gyr_w: 0.000019393
g_norm: 9.81

# 时间同步
estimate_td: 1         # 在线估计时间偏移
td: 0.01484888826656275    # 初始时间偏移(s)

# 回环检测
load_previous_pose_graph: 0
pose_graph_save_path: "/home/l/output"
save_image: 0

# 特征算法
sift_flag: 1          # 0=Shi-Tomasi, 1=SIFT-GPU